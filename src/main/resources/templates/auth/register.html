<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Register</title>
</head>
<body>
<h2>Register</h2>
<form onsubmit="registerUser(event)">
    <label>Fullname:</label>
    <input type="text" id="fullname" required/><br/>
    <label>Username:</label>
    <input type="text" id="username" required/><br/>
    <label>Email:</label>
    <input type="email" id="email" required/><br/>
    <label>Password:</label>
    <input type="password" id="password" required/><br/>
    <label>Role:</label>
    <select id="role" required>
        <option value="ADMIN">Admin</option>
        <option value="ORGANIZER">Organizer</option>
        <option value="ATTENDEE">Attendee</option>
    </select><br/>
    <button type="submit">Register</button>
</form>
<div id="registerResult" style="color:red;"></div>
<p>
    Sudah punya akun?
    <a href="/login">Login</a>
</p>
<script>
    function registerUser(e) {
        e.preventDefault();
        fetch('/api/auth/register', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            credentials: 'include',
            body: JSON.stringify({
                fullName: document.getElementById('fullname').value,
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                role: document.getElementById('role').value
            })
        })
            .then(response => response.json())
            .then(data => {
                if (data.id) {
                    window.location.href = "/dashboard";
                } else {
                    document.getElementById("registerResult").innerText = data.error || "Registration failed";
                }
            });
    }
</script>
</body>
</html>